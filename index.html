<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Golf Practice Tracker</title>
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    :root{--bg:#0b1220;--card:#101829;--ink:#e5ecff;--muted:#9db4ff;--accent:#38bdf8;--ok:#22c55e;--bad:#ef4444;--warn:#f59e0b}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial; background:linear-gradient(180deg,#0b1220,#0f172a); color:var(--ink)}
    a{color:var(--accent)}
    .wrap{max-width:980px;margin:0 auto;padding:16px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;position:sticky;top:0;background:rgba(11,18,32,.85);backdrop-filter:blur(6px);padding:10px 16px;border-bottom:1px solid #1f2a44;z-index:5}
    .title{display:flex;gap:10px;align-items:center}
    nav{display:flex;gap:8px}
    .tab{border:1px solid #1f2a44;background:var(--card);color:var(--ink);padding:8px 12px;border-radius:12px;cursor:pointer}
    .tab.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(56,189,248,.25) inset}
    .grid{display:grid;gap:12px}
    .cards{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .card{background:var(--card);border:1px solid #1f2a44;border-radius:16px;padding:14px}
    h1,h2,h3{margin:0 0 8px}
    h1{font-size:22px}
    h2{font-size:18px;color:var(--muted)}
    h3{font-size:16px;color:var(--muted)}
    label{font-size:13px;color:#c7d2fe}
    input,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #2a3558;background:#0c1427;color:var(--ink);outline:none}
    input[type=number]{appearance:textfield}
    .row{display:flex;gap:10px}
    .row>div{flex:1}
    .btn{display:inline-flex;gap:8px;align-items:center;justify-content:center;background:var(--accent);border:0;color:#052338;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid #1f2a44;color:var(--ink)}
    .btn.warn{background:var(--bad);color:white}
    .small{font-size:12px;color:var(--muted)}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid #1f2a44;padding:8px 6px;text-align:left;font-size:13px}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid #223055;color:#c7d2fe;font-size:12px}
    .stat{display:flex;flex-direction:column;gap:6px}
    .stat b{font-size:20px}
    footer{color:var(--muted);text-align:center;margin:40px 0}
    .hide{display:none}
  </style>
</head>
<body>
  <header>
    <div class="title">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none"><path d="M20 21H4m4.5-5.5L20 3l-5.5 11.5L9 15.5Z" stroke="#38bdf8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="6" cy="18" r="2" stroke="#38bdf8"/></svg>
      <div>
        <h1>Golf Practice Tracker</h1>
        <div class="small">Stats saved locally on device</div>
      </div>
    </div>
    <nav>
      <button class="tab active" data-tab="plan">Plan</button>
      <button class="tab" data-tab="log">Log Practice</button>
      <button class="tab" data-tab="stats">Stats</button>
    </nav>
  </header>

  <main class="wrap">
    <!-- PLAN TAB -->
    <section id="plan" class="grid">
      <div class="card">
        <h2>Practice Plan</h2>
        <p class="small">Edit any text below to match what you want to do. It auto-saves.</p>
        <textarea id="planText" rows="14"></textarea>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn" id="resetPlan">Reset to Template</button>
          <button class="btn ghost" id="copyPlan">Copy Text</button>
        </div>
      </div>
    </section>

    <!-- LOG TAB -->
    <section id="log" class="grid hide">
      <div class="card">
        <h2>Practice Log</h2>
        <div class="row">
          <div>
            <label>Date</label>
            <input id="date" type="date" />
          </div>
        </div>
      </div>

      <div class="grid cards">
        <div class="card">
          <h3>Putting</h3>
          <div class="row">
            <div>
              <label>Gate — Made</label>
              <input id="put_gate_m" type="number" min="0" />
            </div>
            <div>
              <label>Gate — Attempts</label>
              <input id="put_gate_t" type="number" min="1" placeholder="20" />
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div>
              <label>Circle 3ft — Made</label>
              <input id="put_circle_m" type="number" min="0" />
            </div>
            <div>
              <label>Circle 3ft — Attempts</label>
              <input id="put_circle_t" type="number" min="1" placeholder="10" />
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div>
              <label>Lag Points — Points</label>
              <input id="put_lag_m" type="number" min="0" />
            </div>
            <div>
              <label>Lag Points — Max Points</label>
              <input id="put_lag_t" type="number" min="1" placeholder="15" />
            </div>
          </div>
          <div style="margin-top:8px">
            <label>Notes</label>
            <input id="put_notes" type="text" placeholder="tempo, start line, etc." />
          </div>
        </div>

        <div class="card">
          <h3>Chipping</h3>
          <div class="row">
            <div>
              <label>Towel — Hits</label>
              <input id="chip_towel_m" type="number" min="0" />
            </div>
            <div>
              <label>Towel — Attempts</label>
              <input id="chip_towel_t" type="number" min="1" placeholder="30" />
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div>
              <label>Up & Down — Makes</label>
              <input id="chip_updown_m" type="number" min="0" />
            </div>
            <div>
              <label>Up & Down — Attempts</label>
              <input id="chip_updown_t" type="number" min="1" placeholder="9" />
            </div>
          </div>
          <div style="margin-top:8px">
            <label>Technical Reps Notes</label>
            <input id="chip_notes" type="text" placeholder="bump&run / mid pitch…" />
          </div>
        </div>

        <div class="card">
          <h3>Range</h3>
          <div class="row">
            <div>
              <label>Wedge 1 (yd) & Avg Carry</label>
              <div class="row"><input id="wed1_y" type="number" placeholder="50"/><input id="wed1_c" type="number" placeholder="carry"/></div>
            </div>
            <div>
              <label>Wedge 2 (yd) & Avg Carry</label>
              <div class="row"><input id="wed2_y" type="number" placeholder="75"/><input id="wed2_c" type="number" placeholder="carry"/></div>
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div>
              <label>Wedge 3 (yd) & Avg Carry</label>
              <div class="row"><input id="wed3_y" type="number" placeholder="100"/><input id="wed3_c" type="number" placeholder="carry"/></div>
            </div>
            <div>
              <label>Virtual 9 GIR — Makes</label>
              <input id="rng_gir_m" type="number" min="0" />
            </div>
            <div>
              <label>Virtual 9 GIR — Attempts</label>
              <input id="rng_gir_t" type="number" min="1" placeholder="9" />
            </div>
          </div>
          <div class="row" style="margin-top:8px">
            <div>
              <label>7i Narrow Target — Makes</label>
              <input id="rng_iron_m" type="number" min="0" />
            </div>
            <div>
              <label>7i — Attempts</label>
              <input id="rng_iron_t" type="number" min="1" placeholder="10" />
            </div>
            <div>
              <label>Driver Narrow Target — Makes</label>
              <input id="rng_drv_m" type="number" min="0" />
            </div>
            <div>
              <label>Driver — Attempts</label>
              <input id="rng_drv_t" type="number" min="1" placeholder="10" />
            </div>
          </div>
          <div style="margin-top:8px">
            <label>Notes</label>
            <input id="rng_notes" type="text" placeholder="shape, start lines, tempo…" />
          </div>
        </div>
      </div>

      <div class="card">
        <h3>Session Notes</h3>
        <textarea id="notes" rows="4" placeholder="What went well? What to adjust next time?"></textarea>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button id="save" class="btn">Save Session</button>
          <button id="clearForm" class="btn ghost">Clear Form</button>
        </div>
      </div>
    </section>

    <!-- STATS TAB -->
    <section id="stats" class="grid hide">
      <div class="grid cards">
        <div class="card">
          <h2>Averages (Last 10)</h2>
          <div class="grid" style="grid-template-columns:repeat(2,minmax(0,1fr));gap:12px">
            <div class="stat"><span class="small">Gate Drill</span><b id="avg_gate">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Circle 3ft</span><b id="avg_circle">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Lag Points</span><b id="avg_lag">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Towel Hits</span><b id="avg_towel">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Up & Downs</span><b id="avg_updown">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Virtual 9 GIR</span><b id="avg_gir">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">7i Narrow Target</span><b id="avg_iron">–</b><span class="small">%</span></div>
            <div class="stat"><span class="small">Driver Narrow Target</span><b id="avg_drv">–</b><span class="small">%</span></div>
          </div>
        </div>

        <div class="card">
          <h2>Data</h2>
          <div style="display:flex;gap:8px;margin-bottom:8px">
            <button id="exportBtn" class="btn">Export JSON</button>
            <label class="btn ghost" for="importFile" style="cursor:pointer">Import JSON<input id="importFile" type="file" accept="application/json" style="display:none"/></label>
            <button id="resetAll" class="btn warn">Reset All Data</button>
          </div>
          <div class="small">Tip: export occasionally so you can keep a backup or move devices.</div>
        </div>
      </div>

      <div class="card">
        <h2>Sessions</h2>
        <table id="tbl">
          <thead>
            <tr>
              <th>Date</th>
              <th>Putting (Gate / Circle / Lag)</th>
              <th>Chipping (Towel / U&D)</th>
              <th>Range (GIR / 7i / Dr)</th>
              <th>Notes</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

  <footer class="wrap small">100% client-side. Data lives in your browser via localStorage. Works great on iPhone via GitHub Pages.</footer>

  <script>
    const $ = (q)=>document.querySelector(q);
    const store = {
      get key(){ return 'fg_practice_sessions_v1'; },
      get planKey(){ return 'fg_practice_plan_v1'; },
      load(){ return JSON.parse(localStorage.getItem(this.key)||'[]'); },
      save(list){ localStorage.setItem(this.key, JSON.stringify(list)); },
      loadPlan(){ return localStorage.getItem(this.planKey); },
      savePlan(txt){ localStorage.setItem(this.planKey, txt); }
    };

    // Tabs
    document.querySelectorAll('.tab').forEach(btn=>btn.addEventListener('click',()=>{
      document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const tab = btn.dataset.tab;
      document.querySelectorAll('main section').forEach(s=>s.classList.add('hide'));
      document.getElementById(tab).classList.remove('hide');
      if(tab==='stats') render();
    }));

    // Plan template
    const template = `Putting — 30min
• Gate Drill: 20 putts within 6ft (score /20)
• Circle Drill: 10 balls at 3ft (make all /10)
• Lag Putting: 5 balls @ 20/30/40ft — 1pt inside 3ft (/15)

Chipping — 30min
• Technical Reps: pick 2 shots (high/low), 10 balls each
• Landing Spot: 30 balls; towel 3–5ft on green (score hits /30)
• Pressure: 9 different chips → putt out (Up&Down % /9)

Range — 30min
• Wedge Work: 3 stock distances; 5 balls each (record avg carry)
• Start Lines: 10 irons, 10 drivers (narrow target hits)
• Virtual 9: random targets; full pre-shot routine (GIR /9)`;

    const planText = $('#planText');
    function loadPlanUI(){ planText.value = store.loadPlan() || template; }
    loadPlanUI();

    planText.addEventListener('input', ()=> store.savePlan(planText.value));
    $('#resetPlan').onclick = ()=>{ if(confirm('Reset plan text to template?')) { planText.value = template; store.savePlan(planText.value); }};
    $('#copyPlan').onclick = async ()=>{ try{ await navigator.clipboard.writeText(planText.value); alert('Plan copied to clipboard.'); }catch(e){ alert('Could not copy.'); }};

    // Date
    const today = new Date();
    $('#date').valueAsDate = today;

    $('#clearForm').onclick = ()=>{
      document.querySelectorAll('#log input, #log textarea').forEach(el=>{ if(el.type==='date') return; el.value=''; });
    };

    function num(v){ return +v || 0; }

    // Save
    $('#save').onclick = ()=>{
      const s = {
        id: crypto.randomUUID(),
        date: $('#date').value || new Date().toISOString().slice(0,10),
        put: {
          gate:{m:num($('#put_gate_m').value), t:num($('#put_gate_t').value)},
          circle:{m:num($('#put_circle_m').value), t:num($('#put_circle_t').value)},
          lag:{m:num($('#put_lag_m').value), t:num($('#put_lag_t').value)},
          notes: $('#put_notes').value||''
        },
        chip: {
          towel:{m:num($('#chip_towel_m').value), t:num($('#chip_towel_t').value)},
          updown:{m:num($('#chip_updown_m').value), t:num($('#chip_updown_t').value)},
          notes: $('#chip_notes').value||''
        },
        rng: {
          wedges:[
            {y:num($('#wed1_y').value), c:num($('#wed1_c').value)},
            {y:num($('#wed2_y').value), c:num($('#wed2_c').value)},
            {y:num($('#wed3_y').value), c:num($('#wed3_c').value)}
          ],
          gir:{m:num($('#rng_gir_m').value), t:num($('#rng_gir_t').value)},
          iron:{m:num($('#rng_iron_m').value), t:num($('#rng_iron_t').value)},
          drv:{m:num($('#rng_drv_m').value), t:num($('#rng_drv_t').value)},
          notes: $('#rng_notes').value||''
        },
        notes: $('#notes').value||''
      };

      const list = store.load();
      list.unshift(s);
      store.save(list);
      alert('Session saved.');
      render();
    };

    // Helpers for %
    function pct(pair){ return pair && pair.t>0 ? (pair.m/pair.t*100) : null; }
    function fmtPair(pair){
      if(!pair || !pair.t) return '–';
      const p = ((pair.m/pair.t)*100).toFixed(0);
      return `${pair.m}/${pair.t} (${p}%)`;
    }
    function avgPct(list, getter, take=10){
      const slice = list.slice(0,take);
      const vals = slice.map(s=> getter(s)).filter(v=> v!=null && !isNaN(v));
      if(!vals.length) return null; return (vals.reduce((a,b)=>a+b,0)/vals.length).toFixed(1);
    }
    function avgRaw(list, getter, take=10){
      const slice = list.slice(0,take);
      const vals = slice.map(s=> getter(s)).filter(v=> typeof v==='number' && !isNaN(v));
      if(!vals.length) return null; return (vals.reduce((a,b)=>a+b,0)/vals.length).toFixed(1);
    }

    function render(){
      const list = store.load();

      // Averages (percentages for putting, chipping, range accuracy)
      document.getElementById('avg_gate').textContent = (avgPct(list, s=> pct(s.put.gate)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_circle').textContent = (avgPct(list, s=> pct(s.put.circle)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_lag').textContent = (avgPct(list, s=> pct(s.put.lag)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_towel').textContent = (avgPct(list, s=> pct(s.chip.towel)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_updown').textContent = (avgPct(list, s=> pct(s.chip.updown)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_gir').textContent = (avgPct(list, s=> pct(s.rng.gir)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_iron').textContent = (avgPct(list, s=> pct(s.rng.iron)) ?? '–') + (list.length?'%':'');
      document.getElementById('avg_drv').textContent = (avgPct(list, s=> pct(s.rng.drv)) ?? '–') + (list.length?'%':'');

      // Table
      const tbody = document.querySelector('#tbl tbody');
      tbody.innerHTML = '';
      list.forEach(s=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><span class="pill">${s.date}</span></td>
          <td>Gate ${fmtPair(s.put.gate)} • Circle ${fmtPair(s.put.circle)} • Lag ${fmtPair(s.put.lag)}</td>
          <td>Towel ${fmtPair(s.chip.towel)} • U&D ${fmtPair(s.chip.updown)}</td>
          <td>GIR ${fmtPair(s.rng.gir)} • 7i ${fmtPair(s.rng.iron)} • Dr ${fmtPair(s.rng.drv)}</td>
          <td class="small">${(s.notes||'').slice(0,60)}</td>
          <td><button class="btn ghost" data-del="${s.id}">Delete</button></td>`;
        tbody.appendChild(tr);
      });

      tbody.querySelectorAll('button[data-del]').forEach(b=>b.onclick=()=>{
        const id = b.dataset.del;
        const list = store.load().filter(x=>x.id!==id);
        store.save(list); render();
      });
    }

    render();

    // Export / Import / Reset
    document.getElementById('exportBtn').onclick = ()=>{
      const data = {plan: store.loadPlan()||template, sessions: store.load()};
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'golf_practice_backup.json';
      a.click();
    };

    document.getElementById('importFile').addEventListener('change', (e)=>{
      const file = e.target.files[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = ()=>{
        try{
          const data = JSON.parse(reader.result);
          if(data.plan) store.savePlan(data.plan);
          if(Array.isArray(data.sessions)) store.save(data.sessions);
          loadPlanUI(); render();
          alert('Import complete.');
        }catch(err){ alert('Import failed. Invalid file.'); }
      };
      reader.readAsText(file);
    });

    document.getElementById('resetAll').onclick = ()=>{
      if(confirm('This will delete ALL saved sessions and plan text on this device. Proceed?')){
        localStorage.removeItem(store.key);
        localStorage.removeItem(store.planKey);
        loadPlanUI(); render();
      }
    };
  </script>
</body>
</html>

