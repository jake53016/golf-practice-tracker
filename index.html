<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Golf Tracker ‚Äî test
</title>
<style>
  :root{
    --bg:#0b0c10;
    --card:#14161b;
    --surface:#191c22;
    --text:#e7eaf0;
    --muted:#a9b0bd;
    --accent:#76e4f7;
    --accent-2:#7cf29a;
    --danger:#ff6b6b;
    --shadow:0 8px 24px rgba(0,0,0,.35);
    --radius:12px;
    --space:12px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--text);
    font:400 16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  a{color:var(--accent);text-decoration:none}
  .app{
    min-height:100%;
    display:grid;
    grid-template-rows:auto 1fr auto;
  }
  header{
    position:sticky;top:0;z-index:5;
    background:linear-gradient(180deg,rgba(25,28,34,.95),rgba(25,28,34,.8));
    backdrop-filter: blur(8px);
    padding:10px 16px;border-bottom:1px solid rgba(255,255,255,.06);
  }
  header .title{font-weight:700;letter-spacing:.2px}
  header .subtitle{font-size:.85rem;color:var(--muted)}
  main{padding:16px 16px 96px}
  .hidden{display:none !important}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .space{height:8px}
  .card{
    background:var(--card);border:1px solid rgba(255,255,255,.06);
    border-radius:var(--radius);padding:14px;box-shadow:var(--shadow);
  }
  .card + .card{margin-top:12px}
  .card h3{margin:0 0 8px;font-size:1.05rem}
  .muted{color:var(--muted)}
  .chip{
    display:inline-flex;align-items:center;gap:8px;
    padding:8px 12px;border-radius:999px;
    background:var(--surface);border:1px solid rgba(255,255,255,.06);
    cursor:pointer;user-select:none
  }
  .chip.active{outline:2px solid var(--accent)}
  button, .btn{
    appearance:none;border:0;border-radius:10px;
    padding:12px 14px;background:var(--surface);
    color:var(--text);font-weight:600;cursor:pointer;
    border:1px solid rgba(255,255,255,.06);
  }
  .btn.primary{background:linear-gradient(180deg,var(--accent),#3bb9cf); color:#001b22}
  .btn.success{background:linear-gradient(180deg,var(--accent-2),#30bf6b); color:#021b0e}
  .btn.danger{background:linear-gradient(180deg,var(--danger),#e24a4a); color:#2a0404}
  .btn.ghost{background:transparent;border:1px dashed rgba(255,255,255,.2)}
  .cta-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .cta-grid .btn{width:100%}
  .list{display:grid;gap:10px}
  .list .item{
    display:flex;align-items:center;justify-content:space-between;gap:12px;
    padding:12px;border-radius:10px;background:var(--surface);
    border:1px solid rgba(255,255,255,.06)
  }
  .pill{padding:6px 10px;border-radius:999px;background:#0f1217;border:1px solid rgba(255,255,255,.08);font-size:.8rem;color:var(--muted)}
  .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:.8rem;background:#0e1116;padding:2px 6px;border-radius:6px;border:1px solid rgba(255,255,255,.08)}
  .highlight{background:linear-gradient(90deg,rgba(118,228,247,.15),rgba(124,242,154,.15));border-left:3px solid var(--accent);padding:10px;border-radius:8px}
  /* Bottom nav */
  nav.bottom{
    position:fixed;left:0;right:0;bottom:0;z-index:10;
    background:linear-gradient(180deg,rgba(25,28,34,.9),rgba(25,28,34,1));
    backdrop-filter: blur(8px);
    border-top:1px solid rgba(255,255,255,.06);
    display:flex;justify-content:space-around;align-items:center;height:68px;
  }
  nav .tab{
    display:flex;flex-direction:column;align-items:center;gap:4px;
    font-size:.78rem;color:var(--muted);padding:8px 6px;min-width:64px
  }
  nav .tab.active{color:var(--text)}
  nav .tab svg{width:22px;height:22px}
  /* FAB */
  .fab{
    position:fixed;right:16px;bottom:84px;z-index:11;
    border-radius:28px;padding:14px 16px;
    display:flex;align-items:center;gap:8px;
    box-shadow:var(--shadow);
  }
  .fab .dot{width:10px;height:10px;border-radius:50%;background:#00434d;box-shadow:0 0 0 6px rgba(0,0,0,.2)}
  /* Bottom sheet */
  .sheet{
    position:fixed;left:0;right:0;bottom:-100%;z-index:20;
    background:var(--card);border-top-left-radius:18px;border-top-right-radius:18px;
    box-shadow:0 -12px 32px rgba(0,0,0,.5);
    transition:bottom .25s ease; padding:16px;border:1px solid rgba(255,255,255,.08)
  }
  .sheet.open{bottom:0}
  .sheet .handle{width:48px;height:5px;border-radius:999px;background:#2a2f38;margin:0 auto 12px}
  .field{display:grid;gap:6px;margin:10px 0}
  input, select, textarea{
    width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.08);
    background:#0f1319;color:var(--text)
  }
  textarea{min-height:80px;resize:vertical}
  .split{display:grid;grid-template-columns:1fr auto;gap:10px}
  .sticky-bar{
    position:sticky;bottom:-16px;background:linear-gradient(180deg,transparent,rgba(25,28,34,1));
    padding-top:10px;margin-top:12px
  }
  .banner{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    padding:12px;border-radius:10px;background:#102026;border:1px solid rgba(118,228,247,.25)
  }
  .grid{display:grid;gap:12px}
  .grid.cols-3{grid-template-columns:repeat(3,1fr)}
  .grid.cols-2{grid-template-columns:repeat(2,1fr)}
  @media(min-width:900px){
    main{max-width:960px;margin:0 auto}
  }
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="row" style="justify-content:space-between">
      <div>
        <div class="title">Golf Tracker</div>
        <div class="subtitle" id="headerSubtitle">Home</div>
      </div>
      <div class="row">
        <span class="pill" id="sessionPill">Idle</span>
      </div>
    </div>
  </header>

  <main>
    <!-- HOME -->
    <section id="page-home">
      <div id="resumeBanner" class="banner hidden">
        <div>‚è∏Ô∏è You have a paused session.</div>
        <div class="row">
          <button class="btn" onclick="goto('log');resumeSession()">Resume</button>
          <button class="btn ghost" onclick="endSession()">End</button>
        </div>
      </div>

      <div class="card">
        <h3>Hello üëã</h3>
        <div class="muted">Quick actions</div>
        <div class="space"></div>
        <div class="cta-grid">
          <button class="btn primary" onclick="startDraft()">Start Practice</button>
          <button class="btn" onclick="openSheet('quickLogSheet')">Quick Log</button>
        </div>
      </div>

      <div class="card">
        <h3>Continue where you left off</h3>
        <div id="continueList" class="list muted">No paused sessions.</div>
      </div>

      <div class="card">
        <h3>Recent Sessions</h3>
        <div id="recentList" class="list"></div>
        <div class="sticky-bar">
          <button class="btn ghost" onclick="seedFakeHistory()">Seed sample history</button>
        </div>
      </div>

      <div class="card">
        <h3>Highlights</h3>
        <div class="grid cols-2">
          <div class="highlight">üî• Streak: <b id="streakDays">0</b> days</div>
          <div class="highlight">üèåÔ∏è Best 7i FG% (30d): <b>63%</b></div>
        </div>
      </div>
    </section>

    <!-- LOG -->
    <section id="page-log" class="hidden">
      <div class="card">
        <h3>Session</h3>
        <div class="row">
          <span class="pill">Plan: <b id="planNamePill">Default</b></span>
          <span class="pill">Status: <b id="statusPill">Idle</b></span>
          <span class="pill">Elapsed: <b id="elapsedPill">00:00</b></span>
        </div>
        <div class="space"></div>
        <div id="logEmpty" class="muted">No active session. Tap <span class="kbd">Start</span> to begin.</div>

        <div id="logBody" class="hidden">
          <div class="card">
            <h3>Points Drill</h3>
            <div class="row">
              <button class="btn" onclick="addPoints(1)">+1</button>
              <button class="btn" onclick="addPoints(3)">+3</button>
              <button class="btn" onclick="addPoints(-1)">-1</button>
            </div>
            <div class="space"></div>
            <div>Total Points: <b id="pointsTotal">0</b></div>
          </div>

          <div class="card">
            <h3>Attempts</h3>
            <div class="row">
              <button class="btn success" onclick="addAttempt(true)">Made</button>
              <button class="btn danger" onclick="addAttempt(false)">Miss</button>
            </div>
            <div class="space"></div>
            <div>Attempts: <b id="attemptsCount">0</b> ‚Ä¢ Makes: <b id="makesCount">0</b> ‚Ä¢ Acc: <b id="accPct">0%</b></div>
          </div>

          <div class="card">
            <h3>Quick Note</h3>
            <textarea id="noteBox" placeholder="Windy left-to-right, focus on tempo..."></textarea>
          </div>

          <div class="sticky-bar row" style="justify-content:space-between">
            <div class="row">
              <button id="btnStart" class="btn primary" onclick="startSession()">Start</button>
              <button id="btnPause" class="btn" onclick="pauseSession()" disabled>Pause</button>
              <button id="btnEnd" class="btn ghost" onclick="endSession()" disabled>End</button>
            </div>
            <button class="btn" onclick="saveAsPreset()">Save as Preset</button>
          </div>
        </div>
      </div>
    </section>

    <!-- STATS -->
    <section id="page-stats" class="hidden">
      <div class="card">
        <h3>Overview</h3>
        <div class="muted">This prototype shows placeholders. Filters and charts come later.</div>
        <div class="space"></div>
        <div class="grid cols-3">
          <div class="highlight">üóìÔ∏è Last 30d Sessions: <b id="count30">0</b></div>
          <div class="highlight">üèÜ Personal Best (to par): <b>-3</b></div>
          <div class="highlight">üïí Avg Session: <b>42m</b></div>
        </div>
      </div>
    </section>

    <!-- LIBRARY -->
    <section id="page-library" class="hidden">
      <div class="card">
        <h3>Library</h3>
        <div class="row">
          <span class="chip active" data-lib="drills" onclick="switchLib(this)">Drills</span>
          <span class="chip" data-lib="courses" onclick="switchLib(this)">Courses</span>
          <span class="chip" data-lib="presets" onclick="switchLib(this)">Presets</span>
        </div>
      </div>

      <div id="lib-drills" class="card">
        <h3>Drills</h3>
        <div class="list" id="drillList"></div>
      </div>

      <div id="lib-courses" class="card hidden">
        <h3>Courses</h3>
        <div class="muted">Add your courses later.</div>
      </div>

      <div id="lib-presets" class="card hidden">
        <h3>Presets</h3>
        <div class="list" id="presetList"></div>
        <div class="space"></div>
        <div class="split">
          <input id="newPresetName" placeholder="New preset name"/>
          <button class="btn" onclick="addPreset()">Add</button>
        </div>
        <div class="muted">‚ÄúDefault‚Äù is pinned and cannot be deleted. Names must be unique and non-empty.</div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section id="page-settings" class="hidden">
      <div class="card">
        <h3>Settings</h3>
        <div class="list">
          <div class="item">
            <span>Units</span>
            <select><option>Imperial</option><option>Metric</option></select>
          </div>
          <div class="item">
            <span>Sounds/Haptics</span>
            <select><option>On</option><option>Off</option></select>
          </div>
          <div class="item">
            <span>Export Data</span>
            <button class="btn ghost" onclick="alert('Coming soon')">Export</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom FAB -->
  <button class="btn primary fab" onclick="startDraft()">
    <div class="dot"></div> Start Practice
  </button>

  <!-- Bottom Nav -->
  <nav class="bottom">
    <div class="tab active" data-page="home" onclick="goto('home')" title="Home">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3l9 8h-3v9h-5v-6H11v6H6v-9H3z"/></svg>
      <div>Home</div>
    </div>
    <div class="tab" data-page="log" onclick="goto('log')" title="Log">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v2H4zm0 7h16v2H4zm0 7h10v2H4z"/></svg>
      <div>Log</div>
    </div>
    <div class="tab" data-page="stats" onclick="goto('stats')" title="Stats">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 17h2v4H3zm4-6h2v10H7zm4-4h2v14h-2zm4 8h2v6h-2zm4-12h2v18h-2z"/></svg>
      <div>Stats</div>
    </div>
    <div class="tab" data-page="library" onclick="goto('library')" title="Library">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6h16v2H4zm0 4h10v2H4zm0 4h16v2H4zm0 4h10v2H4z"/></svg>
      <div>Library</div>
    </div>
    <div class="tab" data-page="settings" onclick="goto('settings')" title="More">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 8a4 4 0 100 8 4 4 0 000-8zM4 12a8 8 0 0116 0 8 8 0 11-16 0z"/></svg>
      <div>More</div>
    </div>
  </nav>

  <!-- Sheets -->
  <div id="quickLogSheet" class="sheet" aria-modal="true" role="dialog">
    <div class="handle"></div>
    <h3>Quick Log</h3>
    <div class="field">
      <label>Type</label>
      <select id="qlType">
        <option>9 holes after work</option>
        <option>Putting practice</option>
        <option>Range session</option>
      </select>
    </div>
    <div class="field">
      <label>Notes</label>
      <textarea id="qlNotes" placeholder="How did it go?"></textarea>
    </div>
    <div class="row" style="justify-content:flex-end;gap:8px">
      <button class="btn ghost" onclick="closeSheet('quickLogSheet')">Cancel</button>
      <button class="btn primary" onclick="submitQuickLog()">Save</button>
    </div>
  </div>
</div>

<script>
// ---------- Simple state ----------
const state = {
  route:'home',
  session:{
    id:null,
    status:'idle', // idle | draft | active | paused | ended
    points:0, attempts:0, makes:0,
    startedAt:null, pausedAt:null, elapsedMs:0,
    planName:'Default',
    note:''
  },
  presets:[{id:'p_default', name:'Default', pinned:true}],
  pausedSessions:[],
  recents:[],
  streakDays:0
};

// ---------- Routing ----------
const pages = {
  home: document.getElementById('page-home'),
  log: document.getElementById('page-log'),
  stats: document.getElementById('page-stats'),
  library: document.getElementById('page-library'),
  settings: document.getElementById('page-settings')
};
const headerSubtitle = document.getElementById('headerSubtitle');

function goto(name){
  state.route = name;
  for(const [k,el] of Object.entries(pages)){
    el.classList.toggle('hidden', k!==name);
  }
  document.querySelectorAll('nav .tab').forEach(tab=>{
    tab.classList.toggle('active', tab.dataset.page===name);
  });
  headerSubtitle.textContent = name[0].toUpperCase()+name.slice(1);
  if(name==='home') renderHome();
  if(name==='log') renderLog();
  if(name==='library') renderLibrary();
  if(name==='stats') renderStats();
}

// ---------- Sheets ----------
function openSheet(id){ document.getElementById(id).classList.add('open'); }
function closeSheet(id){ document.getElementById(id).classList.remove('open'); }

function submitQuickLog(){
  const type = document.getElementById('qlType').value;
  const notes = document.getElementById('qlNotes').value.trim();
  state.recents.unshift({id:rid(), label:type, when:new Date(), notes});
  closeSheet('quickLogSheet');
  document.getElementById('qlNotes').value='';
  renderHome();
}

// ---------- Helpers ----------
const rid = ()=>'s_'+Math.random().toString(36).slice(2,9);
function fmtTime(ms){
  const s=Math.floor(ms/1000);
  const mm=String(Math.floor(s/60)).padStart(2,'0');
  const ss=String(s%60).padStart(2,'0');
  return mm+':'+ss;
}

function updateSessionPill(){
  document.getElementById('sessionPill').textContent = state.session.status[0].toUpperCase()+state.session.status.slice(1);
}

let timer=null;
function tick(){
  if(state.session.status==='active'){
    const now=Date.now();
    const base = state.session.startedAt ?? now;
    const lapse = now - base + (state.session.elapsedMs||0);
    document.getElementById('elapsedPill').textContent = fmtTime(lapse);
  }
}

// ---------- Session controls ----------
function startDraft(){
  goto('log');
  if(state.session.status==='idle' || state.session.status==='ended'){
    state.session={...state.session,id:rid(),status:'draft',points:0,attempts:0,makes:0,startedAt:null,elapsedMs:0};
    updateSessionPill();
    renderLog();
  }
}
function startSession(){
  if(state.session.status==='draft' || state.session.status==='paused'){
    state.session.status='active';
    if(state.session.startedAt===null) state.session.startedAt=Date.now();
    if(timer) clearInterval(timer);
    timer=setInterval(tick, 1000);
    updateSessionPill(); renderLog();
  }
}
function pauseSession(){
  if(state.session.status==='active'){
    state.session.status='paused';
    // accumulate elapsed
    state.session.elapsedMs = (Date.now()-state.session.startedAt) + (state.session.elapsedMs||0);
    state.session.startedAt=null;
    if(timer) clearInterval(timer); timer=null;
    state.pausedSessions.unshift({...state.session});
    updateSessionPill(); renderHome(); renderLog();
  }
}
function resumeSession(){
  const s=state.pausedSessions.shift();
  if(!s) return;
  state.session = {...s, status:'active', startedAt:Date.now()};
  if(timer) clearInterval(timer);
  timer=setInterval(tick, 1000);
  updateSessionPill(); renderHome(); renderLog();
}
function endSession(){
  if(state.session.status==='idle') return;
  // finalize elapsed
  if(state.session.status==='active'){
    state.session.elapsedMs = (Date.now()-state.session.startedAt) + (state.session.elapsedMs||0);
  }
  state.session.status='ended';
  if(timer) clearInterval(timer); timer=null;
  updateSessionPill();
  // push to recents
  state.recents.unshift({
    id:state.session.id,
    label:`Session ‚Ä¢ ${state.session.planName}`,
    when:new Date(),
    points:state.session.points,
    attempts:state.session.attempts,
    makes:state.session.makes,
    elapsedMs:state.session.elapsedMs,
    note:state.session.note
  });
  // clear current
  state.session={...state.session,id:null,status:'idle',points:0,attempts:0,makes:0,startedAt:null,elapsedMs:0,note:''};
  renderHome(); renderLog();
}

// ---------- Log interactions ----------
function addPoints(n){
  if(state.session.status==='idle') return alert('Start the session first.');
  state.session.points += n;
  document.getElementById('pointsTotal').textContent = state.session.points;
}
function addAttempt(made){
  if(state.session.status==='idle') return alert('Start the session first.');
  state.session.attempts += 1;
  if(made) state.session.makes += 1;
  const acc = state.session.attempts ? Math.round(100*state.session.makes/state.session.attempts) : 0;
  document.getElementById('attemptsCount').textContent = state.session.attempts;
  document.getElementById('makesCount').textContent = state.session.makes;
  document.getElementById('accPct').textContent = acc + '%';
}
function saveAsPreset(){
  const base='Preset ';
  let n=1;
  while(state.presets.find(p=>p.name===base+n)) n++;
  state.presets.push({id:rid(), name:base+n, pinned:false});
  alert('Saved current as "'+base+n+'"');
  renderLibrary();
}

// ---------- Library ----------
function renderLibrary(){
  // drills
  const drills=[
    {name:'Gate Drill', type:'points', info:'Make as many as you can out of 24.'},
    {name:'Lag Putting', type:'percent', info:'Hit into 3ft circle; track makes.'},
    {name:'Chipping Ladder', type:'other', info:'Vary distance; track attempts.'},
  ];
  const dl = document.getElementById('drillList');
  dl.innerHTML = '';
  drills.forEach(d=>{
    const el = document.createElement('div');
    el.className='item';
    el.innerHTML = `<div>
        <div><b>${d.name}</b> <span class="pill">${d.type}</span></div>
        <div class="muted">${d.info}</div>
      </div>
      <button class="btn" onclick="useDrill('${d.name}')">Use</button>`;
    dl.appendChild(el);
  });

  // presets
  const pl = document.getElementById('presetList');
  pl.innerHTML = '';
  state.presets.forEach(p=>{
    const row = document.createElement('div');
    row.className='item';
    const disabled = p.pinned ? 'disabled' : '';
    row.innerHTML = `<div class="row" style="gap:10px">
        ${p.pinned?'<span class="pill">Pinned</span>':''}
        <input value="${p.name}" data-id="${p.id}" oninput="editPresetName(event)" style="max-width:220px"/>
      </div>
      <div class="row">
        <button class="btn" onclick="applyPreset('${p.id}')">Use</button>
        <button class="btn ghost" ${disabled} onclick="deletePreset('${p.id}')">Delete</button>
      </div>`;
    pl.appendChild(row);
  });
}

function switchLib(el){
  document.querySelectorAll('.chip[data-lib]').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  const target = el.dataset.lib;
  document.getElementById('lib-drills').classList.toggle('hidden', target!=='drills');
  document.getElementById('lib-courses').classList.toggle('hidden', target!=='courses');
  document.getElementById('lib-presets').classList.toggle('hidden', target!=='presets');
}

function addPreset(){
  const name = document.getElementById('newPresetName').value.trim();
  if(!name){ alert('Name cannot be empty.'); return; }
  if(state.presets.some(p=>p.name.toLowerCase()===name.toLowerCase())){
    alert('Duplicate name.'); return;
  }
  state.presets.push({id:rid(), name, pinned:false});
  document.getElementById('newPresetName').value='';
  renderLibrary();
}
function deletePreset(id){
  const p = state.presets.find(x=>x.id===id);
  if(p?.pinned){ alert('Default is pinned and cannot be deleted.'); return; }
  state.presets = state.presets.filter(x=>x.id!==id);
  renderLibrary();
}
function editPresetName(e){
  const id = e.target.dataset.id;
  const v = e.target.value;
  const p = state.presets.find(x=>x.id===id);
  if(!p) return;
  if(p.pinned && v.trim()===''){
    e.target.value = p.name;
    alert('Default cannot be renamed to empty/null.');
    return;
  }
  // simple guardrails: disallow empty and duplicates on blur
  e.target.onblur = ()=>{
    const val = e.target.value.trim();
    if(!val){ e.target.value = p.name; alert('Name cannot be empty.'); return; }
    if(state.presets.some(x=>x.id!==id && x.name.toLowerCase()===val.toLowerCase())){
      e.target.value = p.name; alert('Duplicate name.'); return;
    }
    p.name = val;
  };
}
function applyPreset(id){
  const p = state.presets.find(x=>x.id===id);
  if(!p) return;
  state.session.planName = p.name;
  document.getElementById('planNamePill').textContent = p.name;
  goto('log');
}

// ---------- Home & Stats rendering ----------
function renderHome(){
  // resume banner
  document.getElementById('resumeBanner').classList.toggle('hidden', state.pausedSessions.length===0);
  // continue list
  const cont = document.getElementById('continueList');
  cont.innerHTML = '';
  if(state.pausedSessions.length===0){
    cont.textContent = 'No paused sessions.';
  }else{
    state.pausedSessions.forEach(s=>{
      const el=document.createElement('div');
      el.className='item';
      el.innerHTML = `<div>
        <div><b>${s.planName}</b> ‚Äî ${Math.round((s.elapsedMs||0)/60000)}m</div>
        <div class="muted">Points ${s.points} ‚Ä¢ Acc ${s.attempts?Math.round(100*s.makes/s.attempts):0}%</div>
      </div>
      <button class="btn" onclick="goto('log');resumeSession()">Resume</button>`;
      cont.appendChild(el);
    });
  }
  // recents
  const rec = document.getElementById('recentList'); rec.innerHTML='';
  if(state.recents.length===0){
    rec.innerHTML = `<div class="muted">No sessions yet. Use <span class="kbd">Start Practice</span> to begin.</div>`;
  }else{
    state.recents.slice(0,6).forEach(r=>{
      const el=document.createElement('div'); el.className='item';
      const when = new Date(r.when).toLocaleString();
      const extra = r.points!==undefined ? ` ‚Ä¢ Pts ${r.points} ‚Ä¢ Acc ${r.attempts?Math.round(100*r.makes/r.attempts):0}%` : '';
      el.innerHTML = `<div>
        <div><b>${r.label}</b></div>
        <div class="muted">${when}${extra}</div>
      </div>
      <span class="pill">${r.elapsedMs?fmtTime(r.elapsedMs):''}</span>`;
      rec.appendChild(el);
    });
  }
  // streak (toy calc)
  document.getElementById('streakDays').textContent = state.streakDays;
}

function renderStats(){
  document.getElementById('count30').textContent = state.recents.length;
}

function renderLog(){
  document.getElementById('statusPill').textContent = state.session.status.toUpperCase();
  document.getElementById('planNamePill').textContent = state.session.planName;
  const has = ['draft','active','paused'].includes(state.session.status);
  document.getElementById('logEmpty').classList.toggle('hidden', has);
  document.getElementById('logBody').classList.toggle('hidden', !has);
  // buttons
  document.getElementById('btnStart').disabled = !(state.session.status==='draft' || state.session.status==='paused');
  document.getElementById('btnPause').disabled = !(state.session.status==='active');
  document.getElementById('btnEnd').disabled   = !(state.session.status==='active' || state.session.status==='paused');
  // metrics
  document.getElementById('pointsTotal').textContent = state.session.points;
  document.getElementById('attemptsCount').textContent = state.session.attempts;
  document.getElementById('makesCount').textContent = state.session.makes;
  document.getElementById('accPct').textContent = state.session.attempts? Math.round(100*state.session.makes/state.session.attempts)+'%' : '0%';
  updateSessionPill();
}

// ---------- Drill shortcut ----------
function useDrill(name){
  state.session.planName = name;
  goto('log');
  renderLog();
}

// ---------- Sample data ----------
function seedFakeHistory(){
  const now = Date.now();
  state.recents = [
    {id:rid(), label:'Putting Course ‚Ä¢ Default', when:new Date(now-2*86400000), points:12, attempts:24, makes:16, elapsedMs:38*60000},
    {id:rid(), label:'Chipping ‚Ä¢ Ladder', when:new Date(now-4*86400000), points:8, attempts:18, makes:9, elapsedMs:44*60000},
    {id:rid(), label:'Range ‚Ä¢ 7-iron', when:new Date(now-6*86400000), points:0, attempts:30, makes:18, elapsedMs:50*60000},
  ];
  state.streakDays = 3;
  renderHome(); renderStats();
}

// ---------- Init ----------
renderHome(); renderLibrary(); renderStats();
</script>
</body>
</html>
